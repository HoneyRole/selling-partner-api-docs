# Amazon出品パートナーAPI開発者ガイド

-   [出品パートナーAPIとは](#出品パートナーAPIとは)
    -   [出品パートナーAPI HTTPメソッド](#出品パートナーAPI-HTTPメソッド)
    -   [出品パートナーAPIエンドポイント](#出品パートナーAPIエンドポイント)
    -   [marketplaceId値](#marketplaceId値)
-   [出品パートナーAPIハイブリッドアプリケーション](#出品パートナーAPIハイブリッドアプリケーション)
-   [グローバルアプリケーション](#グローバルアプリケーション)
-   [出品パートナーAPIアプリケーションの登録](#出品パートナーAPIアプリケーションの登録)
    -   [ステップ1.AWSアカウントを作成する](#ステップ1AWSアカウントを作成する)
    -   [ステップ2.AWS IAMポリシーを作成する](#ステップ2AWS-IAMポリシーを作成する)
    -   [ステップ3.IAMユーザーを作成する](#ステップ3IAMユーザーを作成する)
    -   [ステップ4.アプリケーション登録情報を提供する](#ステップ4アプリケーション登録情報を提供する)
-   [開発者情報の表示](#開発者情報の表示)
-   [Selling Partner APIアプリケーションの認可](#Selling-Partner-APIアプリケーションの認可)
    -   [マーケットプレイスアプリストアのワークフロー](#マーケットプレイスアプリストアのワークフロー)
        -   [ステップ1.マーケットプレイスのアプリストアから認可を開始する](#ステップ1マーケットプレイスのアプリストアから認可を開始する)
        -   [ステップ2.出品者がアプリケーションの認可に同意する](#ステップ2出品者がアプリケーションの認可に同意する)
        -   [ステップ3.出品者が開発者のウェブサイトにサインインする](#ステップ3出品者が開発者のウェブサイトにサインインする)
        -   [ステップ4.Amazonから認可情報が送信される](#ステップ4Amazonから認可情報が送信される)
        -   [ステップ5.アプリケーションでLWA認証コードとLWAリフレッシュトークンを交換する](#ステップ5アプリケーションでLWA認証コードとLWAリフレッシュトークンを交換する)
    -   [ウェブサイトワークフロー](#ウェブサイトワークフロー)
        -   [ステップ0.OAuth認可URIを設定する](#ステップ0OAuth認可URIを設定する)
        -   [ステップ1.ウェブサイトから認可を開始する](#ステップ1ウェブサイトから認可を開始する)
        -   [ステップ2.出品者がアプリケーションの認可に同意する](#ステップ2出品者がアプリケーションの認可に同意する)
        -   [ステップ3.Amazonから認可情報が送信される](#ステップ3Amazonから認可情報が送信される)
        -   [ステップ4.アプリケーションでLWA認証コードとLWAリフレッシュトークンを交換する](#ステップ4アプリケーションでLWA認証コードとLWAリフレッシュトークンを交換する)
-   [自己認可](#自己認可)
-   [LWAトークンの交換と認証を使用したJava SDKの生成](#LWAトークンの交換と認証を使用したJava-SDKの生成)
-   [生成されたJava SDKを使用したSelling Partner APIへの接続](#生成されたJava-SDKを使用したSelling-Partner-APIへの接続)
-   [Javaクライアントライブラリの生成](#Javaクライアントライブラリの生成)
-   [出品パートナーAPIへの接続](#出品パートナーAPIへの接続)
    -   [ステップ1.Login with Amazonアクセストークンをリクエストする](#ステップ1Login-with-Amazonアクセストークンをリクエストする)
    -   [ステップ2.出品パートナーAPI URIを構築する](#ステップ2出品パートナーAPI-URIを構築する)
    -   [ステップ3.URIにヘッダーを追加する](#ステップ3URIにヘッダーを追加する)
    -   [ステップ4.リクエストの作成と署名](#ステップ4リクエストの作成と署名)
        -   [認証情報スコープ](#認証情報スコープ)
        -   [Authorizationヘッダー](#Authorizationヘッダー)
-   [レスポンスのフォーマット](#レスポンスのフォーマット)
-   [許可不要のオペレーション](#許可不要のオペレーション)
-   [スロットリング：リクエストを送信できる頻度を制限する](#スロットリングリクエストを送信できる頻度を制限する)
-   [すべてのリクエストにUser-Agentヘッダーを含める](#すべてのリクエストにUser-Agentヘッダーを含める)
-   [Selling Partner APIサンドボックス](#Selling-Partner-APIサンドボックス)
    -   [Selling Partner APIをサンドボックスで呼び出す方法](#Selling-Partner-APIをサンドボックスで呼び出す方法)
    -   [Selling Partner APIサンドボックスのエンドポイント](#Selling-Partner-APIサンドボックスのエンドポイント)
-   [よくあるご質問](#よくあるご質問)



# 出品パートナーAPIとは

出品パートナーAPIはRESETベースのAPIで、これにより出品者は出品、注文、支払い、レポートなどのデータにプログラムからアクセスすることができます。出品パートナーAPIを使用するアプリケーションは、出品効率の向上、人件費の削減、顧客への対応時間の短縮を実現し、出品者のビジネスの成長を支援します。出品パートナーAPIは、Amazonマーケットプレイスウェブサービス（Amazon MWS）の機能に基づいて構築されていますが、開発者や出品者にとっての使いやすさとセキュリティを向上させる機能を提供します。

## 出品パートナーAPIベータプログラム

出品パートナーAPIベータプログラムへの参加は招待者のみとなります。[Selling Partner APIアプリケーションの認可](#Selling-Partner-APIアプリケーションの認可)などのタスクについては、Amazonサポートエンジニアのサポートが必要です。Amazonサポートエンジニアにベータプログラムを依頼するには、[サポートケース](https://developer.amazonservices.jp/support)をオープンします。サポートケースの件名に「Selling Partner APIベータ」と記載してください。

アルファプログラム以降の出品パートナーAPIの変更点は次のとおりです。

-   開発者は、出品者がマーケットプレイスアプリストアの詳細ページから開始できるOAuth認可ワークフローを設定できます。詳しくは、「[マーケットプレイスアプリストアのワークフロー](#マーケットプレイスアプリストアのワークフロー)」をご覧ください。
-   開発者は、出品者が開発者のウェブサイトから開始できるOAuth認可ワークフローを設定できます。詳しくは、「[ウェブサイトワークフロー](#ウェブサイトワークフロー)」をご覧ください。
-   Selling Partner APIとAmazon MWSの両方を呼び出すハイブリッドアプリケーションを作成できます。詳しくは、「[ピュアおよびSelling Partner APIハイブリッドアプリケーション](#ピュアおよびSelling-Partner-APIハイブリッドアプリケーション)」をご覧ください。
-   北米、ヨーロッパ、極東地域に新しいエンドポイントが追加されました。「[出品パートナーAPIエンドポイント](#出品パートナーAPIエンドポイント)」をご覧ください。
-   Amazonでは多数の新しいマーケットプレイスをサポートしています。「[marketplaceId値](#marketplaceId値)」をご覧ください。

## ピュアおよびSelling Partner APIハイブリッドアプリケーション

次の2種類の出品パートナーAPIアプリケーションを構築できます。

- **ピュアSelling Partner APIアプリケーション。** これは、Selling Partner APIへの呼び出しのみを行います。

- **Selling Partner APIハイブリッドアプリケーション。** これにより、出品パートナーAPIとAmazon MWSの両方が呼び出されます。

  詳しくは、「[出品パートナーAPIハイブリッドアプリケーション](#出品パートナーAPIハイブリッドアプリケーション)」をご覧ください。


-   **[出品パートナーAPI HTTPメソッド](#出品パートナーAPI-HTTPメソッド)**  
-   **[出品パートナーAPIエンドポイント](#出品パートナーAPIエンドポイント)**  
-   **[marketplaceId値](#marketplaceId値)**  



## 出品パートナーAPI HTTPメソッド

出品パートナーAPIでは、以下のHTTPメソッドがサポートされます。

| HTTPメソッド | 説明                                                         |
| :----------- | :----------------------------------------------------------- |
| `GET`        | リソースデータまたはリソースのリストを取得します。           |
| `POST`       | 指定されたリソースにエンティティを送信します。サーバーの状態に変化が生じたり副作用を引き起こすことがあります。 |
| `PUT`        | ターゲットリソースの現在のすべての表記をリクエストペイロードに置き換えます。 |

**Parent topic:** [出品パートナーAPIとは](#出品パートナーAPIとは)



## 出品パートナーAPIエンドポイント

Selling Partner APIエンドポイントは、特定のAWSリージョンと関連付けられています。AWSリージョンは、Selling Partner APIを呼び出すときに署名を計算するために必要な認証範囲の一部であるため、重要です。詳しくは、「[認証情報スコープ](#認証情報スコープ)」をご覧ください。

| 出品リージョン                                               | エンドポイント                            | AWSリージョン |
| :----------------------------------------------------------- | :---------------------------------------- | :------------ |
| 北米（カナダ、米国、メキシコ、ブラジルのマーケットプレイス） | `https://sellingpartnerapi-na.amazon.com` | `us-east-1`   |
| ヨーロッパ（スペイン、イギリス、フランス、ドイツ、イタリア、トルコ、アラブ首長国連邦、インドのマーケットプレイス） | `https://sellingpartnerapi-eu.amazon.com` | `eu-west-1`   |
| 極東地域（シンガポール、オーストラリア、日本のマーケットプレイス） | `https://sellingpartnerapi-fe.amazon.com` | `us-west-2`   |

**Parent topic:** [出品パートナーAPIとは](#出品パートナーAPIとは)



## marketplaceId値

`marketplaceId`は、リクエストに対するマーケットプレイスを識別するものです。

**北米**

| 国名           | marketplaceId    | 国名コード |
| :------------- | :--------------- | :--------- |
| カナダ         | `A2EUQ1WTGCTBG2`  | `CA`       |
| アメリカ合衆国 | `ATVPDKIKX0DER`  | `US`       |
| メキシコ       | `A1AM78C64UM0Y8` | `MX`       |
| ブラジル       | `A2Q3Y263D00KWC` | `BR`       |

**ヨーロッパ**

| 国名             | marketplaceId    | 国名コード |
| :--------------- | :--------------- | :--------- |
| スペイン         | `A1RKKUPIHCS9HS` | `ES`       |
| 英国             | `A1F83G8C2ARO7P` | `GB`       |
| フランス         | `A13V1IB3VIYZZH` | `FR`       |
| ドイツ           | `A1PA6795UKMFR9` | `DE`       |
| イタリア         | `APJ6JRA9NG5V4`  | `IT`       |
| トルコ           | `A33AVAJ2PDY3EV` | `TR`       |
| アラブ首長国連邦 | `A2VIGQ35RCS4UG` | `AE`       |
| インド           | `A21TJRUUN4KGV`  | `IN`       |

**極東地域**

| 国名           | marketplaceId    | 国名コード |
| :------------- | :--------------- | :--------- |
| シンガポール   | `A19VAU5U5O7RUS` | `SG`       |
| オーストラリア | `A39IBJ37TRP1C6` | `AU`       |
| 日本           | `A1VC38T7YXB528` | `JP`       |

**Parent topic:** [出品パートナーAPIとは](#出品パートナーAPIとは)



# 出品パートナーAPIハイブリッドアプリケーション

出品パートナーAPIハイブリッドアプリケーションは、出品パートナーAPIとAmazonマーケットプレイスウェブサービス（Amazon MWS）の両方を呼び出すことができるアプリケーションです。ソリューションのために両方のサービスの機能が必要な場合は、ハイブリッドアプリケーションを使用します。出品者が出品パートナーAPIハイブリッドアプリケーションを認可すると、（1）Amazon MWS開発者IDからAmazon MWSを呼び出すことが認可され、（2）アプリケーションから出品パートナーAPIを呼び出すことが認可されます。

Amazonでは、ハイブリッドアプリケーションを単一のアプリケーションと見なしています。たとえば、ハイブリッドアプリケーションをマーケットプレイスアプリストアに公開する場合、そのアプリケーションは単一のアプリケーションとして管理されます。

## Selling Partner APIハイブリッドアプリケーションの作成

Selling Partner APIベータプログラムでは、Selling Partner APIハイブリッドアプリケーションを作成するために、Amazonサポートエンジニアのサポートが必要となります。ベータプログラムの既存のサポートケースを使用するか、新しい[サポートケース](https://developer.amazonservices.jp/support)をオープンすることで、Amazonサポートエンジニアとつながることができます。サポートケースの件名に「Selling Partner APIベータ」と記載してください。

**Selling Partner APIハイブリッドアプリケーションを作成するには**

1. Amazon MWSアプリケーションをマーケットプレイスアプリストアに公開します。アプリケーションの公開の詳細は、Amazon MWSドキュメントの「マーケットプレイスアプリストア掲載登録ガイド」をご覧ください。

2. Amazon MWSアプリケーションをSelling Partner APIアプリケーションとして登録します。「[出品パートナーAPIアプリケーションの登録](#出品パートナーAPIアプリケーションの登録)」をご覧ください。登録情報を提示している間に、Amazon MWSアプリケーションをSelling Partner APIハイブリッドアプリケーションに変換するよう、Amazonサポートエンジニアに依頼します。

   Amazonサポートエンジニアより、アプリケーションが登録され、ドラフトハイブリッドアプリケーションに変換されたことを確認する連絡が通知されます。この時点で、OAuth認可ワークフローを設定およびテストできます。詳しくは、「[Selling Partner APIアプリケーションの認可](#Selling-Partner-APIアプリケーションの認可)」をご覧ください。



# グローバルアプリケーション

選択したリージョンおよびマーケットプレイスで開発者として一度登録するだけで、任意のリージョンまたはマーケットプレイスから出品者が認可できるピュア出品パートナーAPIアプリケーションを作成できるようになります。エンドポイントがアプリケーションを認可した出品者と同じリージョンのものであれば、任意の出品パートナーAPIエンドポイントを呼び出すために必要な開発者認証情報（AWSアクセスキーIDとAWS秘密キー）のセットは1つだけです。AWSアクセスキーIDおよびAWS秘密キーの取得については、「[ステップ3.IAMユーザーを作成する](#ステップ3IAMユーザーを作成する)」をご覧ください。

出品パートナーAPIハイブリッドアプリケーションを使用している場合、Amazonマーケットプレイスウェブサービス（Amazon MWS）エンドポイントへの呼び出しには、Amazon MWSアプリケーションと同じ制限があります。つまり、Amazon MWSエンドポイントを呼び出すときは、エンドポイントを取得したリージョンに関連付けられたAmazon MWSアクセスキーを使用する必要があります。

詳しくは、以下をご覧ください。

-   [ピュアおよびSelling Partner APIハイブリッドアプリケーション](#ピュアおよびSelling-Partner-APIハイブリッドアプリケーション)
-   [出品パートナーAPIエンドポイント](#出品パートナーAPIエンドポイント)



# 出品パートナーAPIアプリケーションの登録

[ステップ1.AWSアカウントを作成する](#ステップ1AWSアカウントを作成する)から出品パートナーAPIアプリケーションを登録します。出品パートナーAPIアプリケーションを登録すると、Amazonサポートエンジニアから1つ以上のOAuth認可URIが提供されます。OAuth認可URIを使用して、OAuth認可ワークフローを設定できます。詳しくは、「[Selling Partner APIアプリケーションの認可](#Selling-Partner-APIアプリケーションの認可)」をご覧ください。

-   **[ステップ1.AWSアカウントを作成する](#ステップ1AWSアカウントを作成する)**  

-   **[ステップ2.AWS IAMポリシーを作成する](#ステップ2AWS-IAMポリシーを作成する)**  

-   **[ステップ3.IAMユーザーを作成する](#ステップ3IAMユーザーを作成する)**  

-   **[ステップ4.アプリケーション登録情報を提供する](#ステップ4アプリケーション登録情報を提供する)**  



## ステップ1.AWSアカウントを作成する

出品パートナーAPIセキュリティモデルではAWS認証情報が使用されるため、AWSアカウントが必要です。AWSカスタマーでない場合は、無料のAWSアカウントを作成できます。詳しくは、「[AWS無料利用枠](https://aws.amazon.com/jp/free)」をご覧ください。

**Parent topic:** [出品パートナーAPIアプリケーションの登録](#出品パートナーAPIアプリケーションの登録)



## ステップ2.AWS IAMポリシーを作成する

[ステップ3.IAMユーザーを作成する](#ステップ3IAMユーザーを作成する)で作成するIAMユーザーの権限を定義するには、IDとアクセス管理（IAM）ポリシーが必要です。IAMポリシーによって、出品パートナーAPIを呼び出すためのIAMユーザー権限が付与されます。

**IAMポリシーを作成するには**

1. AWS管理コンソールにサインインし、[console.aws.amazon.com/iam](https://console.aws.amazon.com/iam)でIAMコンソールを開きます。

2. 左側のナビゲーションペインで、「**ポリシー**」をクリックします。

   「**ポリシー**」を初めて選択する場合は、「**管理ポリシーにようこそ**」ページが表示されます。「**開始する**」をクリックします。

3. 「**ポリシーの作成**」ボタンをクリックします。

4. 「**JSON**」タブをクリックします。

5. テキストボックスに次のコードを貼り付け、既存のコードを置き換え、「**ポリシーの確認**」をクリックします。

   ```
   {
       "Version": "2012-10-17",
       "Statement": [
           {
               "Effect": "Allow",
               "Action": "execute-api:Invoke",
               "Resource": "arn:aws:execute-api:*:*:*"
           }
       ]
   }
   ```

6. 「**ポリシーの確認**」ページで、作成するポリシーの「**名前**」と「**説明**」（任意）を入力します。IAMポリシーには`Selling Partner API`の名前を付けることをお勧めします。

7. ポリシーの「**概要**」を確認して、ポリシーによって付与された権限を確認し、「**ポリシーの作成**」ボタンをクリックします。

   新しいIAMポリシーがリストに表示されます。


詳しくは、AWSドキュメントの「[IAMポリシーの作成](#IAMポリシーの作成)」をご覧ください。

**Parent topic:** [出品パートナーAPIアプリケーションの登録](#出品パートナーAPIアプリケーションの登録)



## ステップ3.IAMユーザーを作成する

出品パートナーAPIの呼び出しを認証するためのAWSアクセスキーを取得するには、IAMユーザーが必要です。この目的のためだけでも新たにIAMユーザーを作成することをお勧めします。

登録する際に、IAMユーザーが出品パートナーAPIアプリケーションに関連付けられます。

**IAMユーザーを作成するには**

1. AWS管理コンソールにサインインし、[console.aws.amazon.com/iam](https://console.aws.amazon.com/iam)でIAMコンソールを開きます。

2. 左側のナビゲーションペインで、「**ユーザー**」をクリックし、「**ユーザーを追加**」ボタンをクリックします。

3. 新しいユーザーのユーザー名を入力します。これはAWSのサインイン名となります。

4. 「**プログラムによるアクセス**」を選択し、「**次のステップ： アクセス権限**」ボタンをクリックします。

5. 「**アクセス許可の設定**」ページで、「**既存のポリシーを直接アタッチ**」ボタンをクリックします。

6. ポリシーのリストから、[ステップ2.AWS IAMポリシーを作成する](#ステップ2AWS-IAMポリシーを作成する)で作成したポリシーを選択します。

   **Tip:** 「**ユーザーによる管理**」でフィルタリングすると、ポリシーを簡単に見つけることができます。

7. 「**次のステップ： 確認**」ボタンをクリックすると、この時点までに行ったすべての選択内容が表示されます。続行する準備ができたら、「**ユーザーの作成**」ボタンをクリックします。

   新しいIAMユーザーのAWSアクセスキーIDが表示されます。

8. 「**表示**」をクリックすると、AWS秘密キーが表示されます。AWSアクセスキーを保存するには、「**.csvのダウンロード**」をクリックし、ファイルを安全な場所に保存します。

   **Important:** これは、AWS秘密キーを表示またはダウンロードする唯一の機会です。この秘密キーは、出品パートナーAPIの呼び出しを認証する際に必要となります。AWSアクセスキーIDとAWS秘密キーを安全かつ安全な場所に保存します。**このステップの後でAWSアクセスキーに再度アクセスすることはできません。** AWS秘密キーを紛失した場合は、新しいキーセットを使用して新たにIAMユーザーを作成する必要があります。

9. 「**閉じる**」をクリックします。「**ユーザー名**」列で新しいIAMユーザーをクリックし、ユーザーARNを書き留めます。これは[ステップ4.アプリケーション登録情報を提供する](#ステップ4アプリケーション登録情報を提供する)で必要となります。


詳しくは、AWSドキュメントの「[AWSアカウントでのIAMユーザーの作成](https://docs.aws.amazon.com/ja_jp/IAM/latest/UserGuide/id_users_create.html)」をご覧ください。

**Parent topic:** [出品パートナーAPIアプリケーションの登録](#出品パートナーAPIアプリケーションの登録)



## ステップ4.アプリケーション登録情報を提供する

出品パートナーAPIアプリケーションを登録するには、Amazonサポートエンジニアのサポートが必要です。Amazonサポートエンジニアにベータプログラムを依頼するには、[サポートケース](https://developer.amazonservices.jp/support)をオープンします。サポートケースの件名に「Selling Partner APIベータ」と記載します。

サポートケースを使用して、以下の情報をAmazonに提供してください。

-   **アプリケーションの名前。** マーケットプレイスアプリストアで公開したAmazonマーケットプレイスウェブサービス（Amazon MWS）アプリケーションからハイブリッドアプリケーションを作成する場合は、Amazon MWSアプリケーションの名前を入力します。詳しくは、「[出品パートナーAPIハイブリッドアプリケーション](#出品パートナーAPIハイブリッドアプリケーション)」をご覧ください。
-   **出品者がアプリケーションを認可するためにセラーセントラルにサインインすると予想されるリージョン。** ここで指定するリージョンに応じて、リージョン固有のOAuth認可URIが送信されます。詳しくは、「[ステップ0.OAuth認可URIを設定する](#ステップ0OAuth認可URIを設定する)」をご覧ください。
-   **IAMユーザーのARN。** 「[ステップ3.IAMユーザーを作成する](#ステップ3IAMユーザーを作成する)」をご覧ください。
-   **サインインURI。** これにより、ユーザーエージェントがウェブサイトのサインインページにリダイレクトされます。サインインURIはOAuth 2.0フレームワークに準拠している必要があります。詳しくは、「OAuth 2.0認可フレームワーク」の「[認可エンドポイント](#認可エンドポイント)」をご覧ください。
-   **リダイレクトURI。** これにより、ユーザーエージェントがアプリケーションにリダイレクトされます。リダイレクトURIはOAuth 2.0フレームワークに準拠している必要があります。詳しくは、「OAuth 2.0認可フレームワーク」の「[リダイレクトエンドポイント](https://tools.ietf.org/html/rfc6749#section-3.1.2)」をご覧ください。
-   **開発者の出品者ID。** デベロッパーセントラルにサインインしてアプリケーションの開発者情報を取得できるようにするには、出品パートナーAPIアプリケーションと関連付けるための出品者IDが必要です。これには、IAM ARNとLWA認証情報が含まれます。出品パートナーAPIハイブリッドアプリケーションの場合は、マーケットプレイスアプリストアへの掲載登録用にアプリケーションを登録したときに使用した開発者IDと関連付けられた出品者IDを入力します。詳しくは、「[開発者情報の表示](#開発者情報の表示)」をご覧ください。
-   **Selling Partner APIセクション。** アプリケーションで使用するSelling Partner APIセクションを指定します。
-   **Amazonマーケットプレイスウェブサービス（Amazon MWS）APIセクション。** アプリケーションで使用するAmazon MWSフルフィルメントAPIセクションを示します。

アプリケーションを登録すると、Amazonサポートエンジニアによってサポートケースを通じて以下の内容が提供されます。

- アプリケーションを登録したことの確認。

- 登録されたアプリケーションのアプリケーションID。これを使用して、LWA認証情報とIAM ARNを取得するアプリケーションをデベロッパーセントラルで識別します。詳しくは、「[開発者情報の表示](#開発者情報の表示)」をご覧ください。

- アプリケーションのリージョンのOAuth認可URI。アプリケーションのテスト準備ができたら、これらのOAuth認可URIへのリンクを、認可ワークフローのテストをサポートする出品者に提供できます。OAuth認可URIはアプリケーションの公開時に変更されるため、最低数の出品者にテストを限定することをお勧めします。OAuth認可URIを使用して、自分のウェブサイトから認可を開始することもできます。詳しくは、「[ウェブサイトワークフロー](#ウェブサイトワークフロー)」をご覧ください。

  受け取れるのは、出品者がアプリケーションを認可するリージョンに1つずつ、最大3つのリージョンのOAuth認可URIです。リージョンURIについて詳しくは、「[ステップ0.OAuth認可URIを設定する](#ステップ0OAuth認可URIを設定する)」をご覧ください。


この情報を受け取ったら、開発者情報を表示し、OAuth認可ワークフローを設定できます。詳しくは、「[開発者情報の表示](#開発者情報の表示)」および「[出品パートナーAPIアプリケーションの認可](#出品パートナーAPIアプリケーションの認可)」をご覧ください。

**Parent topic:** [出品パートナーAPIアプリケーションの登録](#出品パートナーAPIアプリケーションの登録)



# 開発者情報の表示

[Selling Partner APIアプリケーションを登録](#Selling-Partner-APIアプリケーションを登録)すると、デベロッパーセントラルにサインインして開発者情報を表示できます。

**開発者情報を表示するには**

1. [ステップ4.アプリケーション登録情報を提供する](#ステップ4アプリケーション登録情報を提供する)で入力した出品者IDに関連付けられているリージョンのデベロッパーセントラルに移動します。

   -   北米：[https://sellercentral.amazon.com/sellingpartner/developerconsole](https://sellercentral.amazon.com/sellingpartner/developerconsole)
   -   ヨーロッパ：[https://sellercentral.amazon.co.uk/sellingpartner/developerconsole](https://sellercentral.amazon.co.uk/sellingpartner/developerconsole)
   -   極東地域：[https://sellercentral.amazon.co.jp/sellingpartner/developerconsole](https://sellercentral.amazon.co.jp/sellingpartner/developerconsole)

2. 前の手順の出品者IDの認証情報を使用してサインインします。

   「**デベロッパーセントラル**」ページが表示され、アプリケーションに関連付けられたIAM ARNが表示されます。

3. 「**LWA認証情報**」をクリックして、LWAクライアントIDとクライアントシークレットを表示します。LWAアクセストークンをリクエストするには、これらの認証情報が必要です。詳しくは、「[ステップ1.Login with Amazonアクセストークンをリクエストする](#ステップ1Login-with-Amazonアクセストークンをリクエストする)」をご覧ください。



# Selling Partner APIアプリケーションの認可

Selling Partner APIの認可モデルは、AmazonのOAuth 2.0実装である[Login with Amazon](https://developer.amazon.com/ja/docs/login-with-amazon/documentation-overview.html)に基づくものです。このモデルでは、出品者は、Amazonおよび開発者のウェブサイトで表示されるページとやり取りすることで、アプリケーションを認可します。出品者のアクションによって、開発者のウェブサイトまたはAmazonのレスポンスが発生します。出品者のブラウザーはユーザーエージェントとなり、出品者がアクションを起こすたびに、開発者のウェブサイトとAmazonの間でパラメーターを渡します。OAuth認証を実装するには、（1）Amazonから渡されるパラメーターを受け入れて処理し、（2）出品者のブラウザーをリダイレクトしてAmazonにパラメーターを渡すように、開発者のウェブサイトを設定する必要があります。

出品者は、次のいずれかのワークフローを使用してアプリケーションを認可できます。

-   [マーケットプレイスアプリストアのワークフロー](#マーケットプレイスアプリストアのワークフロー)。マーケットプレイスアプリストアの詳細ページから開始されるOAuth認可ワークフロー。
-   [ウェブサイトワークフロー](#ウェブサイトワークフロー)。開発者のウェブサイトから開始されるOAuth認可ワークフロー。

また、出品者の代わりに開発者がAmazonマーケットプレイスウェブサービスを呼び出すことについて出品者が許可している場合は、開発者はAuthorization APIを使用して、その認可をSelling Partner APIハイブリッドアプリケーションに移行できます。これにより、出品者に再度認可をリクエストする必要がなくなります。詳しくは、Authorization API User Guideをご覧ください。

-   **[マーケットプレイスアプリストアのワークフロー](#マーケットプレイスアプリストアのワークフロー)**  

-   **[ウェブサイトワークフロー](#ウェブサイトワークフロー)**  



## マーケットプレイスアプリストアのワークフロー

マーケットプレイスアプリストアのワークフローは、マーケットプレイスアプリストアの詳細ページから開始されるOAuth認可ワークフローです。マーケットプレイスアプリストアでSelling Partner APIアプリケーションを公開すると、出品者は詳細ページの「**今すぐ認可**」ボタンをクリックすることでそのアプリケーションを認可できます。

このトピックには、マーケットプレイスアプリストアのワークフロー手順と、ワークフローのテストに関する情報が含まれています。

### マーケットプレイスアプリストアワークフローのテスト

実稼働のマーケットプレイスアプリストアのワークフローを作成する前に、ドラフト状態でアプリケーションを認可できるテストワークフローを作成することが重要です。テストワークフローは、最終的な実稼動ワークフローとまったく同じではありません。それでも、アプリケーションによってパラメーターをAmazonと交換し、認可情報を受け取ることができるかどうかをテストできます。

テストワークフローと実稼働ワークフローの違いは次のとおりです。

- マーケットプレイスアプリストアの詳細ページから開始する代わりに、出品者がアプリケーションのOAuth認可URIに直接移動することでも、テストワークフローを開始できます。信頼できる出品者と連携してテストすることも、自身の出品用アカウントの認証情報を使用してワークフローをテストすることもできます。OAuth認可URIには、`version=beta`パラメーターを含めることで、ワークフローがドラフト状態のアプリケーションを認可していることを示す必要があります。出品者がOAuth認可URIに移動すると、ワークフローは[ステップ2.出品者がアプリケーションの認可に同意する](#ステップ2出品者がアプリケーションの認可に同意する)で続行されます。

  **Note:** 複数リージョンのOAuth認可URIがある場合は、出品するリージョンに対応するOAuth認可URIを出品者に提供してください。

- アプリケーションによって、AmazonコールバックURIに`version=beta`パラメーターが追加されます。「[ステップ3.出品者が開発者のウェブサイトにサインインする](#ステップ3出品者が開発者のウェブサイトにサインインする)」をご覧ください。これにより、ワークフローでアプリケーションがドラフト状態で認可されます。

ワークフローのテストが完了したら、AmazonコールバックURIに`version=beta`パラメーターがこれ以上追加されないよう、ワークフローを更新します。「[ステップ3.出品者が開発者のウェブサイトにサインインする](#ステップ3出品者が開発者のウェブサイトにサインインする)」をご覧ください。これにより、実稼動ワークフローとなります。これで、すべての出品者は、マーケットプレイスアプリストアの詳細ページから公開されたアプリケーションを認可できるようになります。

実稼動ワークフローが[ステップ1.マーケットプレイスのアプリストアから認可を開始する](#ステップ1マーケットプレイスのアプリストアから認可を開始する)で開始します。

-   **[ステップ1.マーケットプレイスのアプリストアから認可を開始する](#ステップ1マーケットプレイスのアプリストアから認可を開始する)**  

-   **[ステップ2.出品者がアプリケーションの認可に同意する](#ステップ2出品者がアプリケーションの認可に同意する)**  

-   **[ステップ3.出品者が開発者のウェブサイトにサインインする](#ステップ3出品者が開発者のウェブサイトにサインインする)**  

-   **[ステップ4.Amazonから認可情報が送信される](#ステップ4Amazonから認可情報が送信される)**  

-   **[ステップ5.アプリケーションでLWA認証コードとLWAリフレッシュトークンを交換する](#ステップ5アプリケーションでLWA認証コードとLWAリフレッシュトークンを交換する)**  


**Parent topic:** [Selling Partner APIアプリケーションの認可](#Selling-Partner-APIアプリケーションの認可)



### ステップ1.マーケットプレイスのアプリストアから認可を開始する

1. 出品者がセラーセントラルにサインインし、マーケットプレイスアプリストアに移動します。

2. 出品者はアプリケーションの詳細ページに移動し、「**今すぐ認可**」ボタンをクリックします。

   アプリケーションの同意ページが表示されます。


**Parent topic:** [マーケットプレイスアプリストアのワークフロー](#マーケットプレイスアプリストアのワークフロー)



### ステップ2.出品者がアプリケーションの認可に同意する

1. 同意ページが表示されたら、出品者はアプリケーションによって要求されたデータアクセスを確認して同意し、「**\[アプリケーション名\]に今すぐログイン**」ボタンをクリックして続行します。「**キャンセル**」ボタンをクリックして、認可せずに終了することもできます。

2. AmazonによってサインインURI（アプリケーション登録時に指定したURI）がブラウザーにロードされ、次のクエリパラメーターが追加されます。

   | パラメーター          | 説明                                                         |
   | :-------------------- | :----------------------------------------------------------- |
   | `amazon_callback_uri` | ブラウザーをAmazonにリダイレクトするためのURI。              |
   | `amazon_state`        | クロスサイトリクエストフォージェリ攻撃から保護するためにAmazonによって生成される状態値。 |
   | `selling_partner_id`  | アプリケーションを認可している出品者の出品者ID。             |

   **Note:** これがテストワークフローの場合（出品者が開発者のOAuth認可URIに移動して開始した場合）、`version=beta`パラメーターが含まれます。これが実稼動ワークフローの場合（出品者がマーケットプレイスアプリストアから開始した場合）、このパラメーターは含まれません。

   たとえば、次のようになります。

   ```
   https://d2yzyfnnpjylxu.cloudfront.net/index.html?amazon_callback_uri=https://amazon.com/apps/authorize/confirm/amzn1.sellerapps.app.2eca283f-9f5a-4d13-b16c-474EXAMPLE57&amazon_state=amazonstateexample&selling_partner_id=A3FHEXAMPLEYWS
   ```

   ウェブサイトのサインインページが表示されます。


**Parent topic:** [マーケットプレイスアプリストアのワークフロー](#マーケットプレイスアプリストアのワークフロー)



### ステップ3.出品者が開発者のウェブサイトにサインインする

1. 出品者が開発者のウェブサイトにサインインします。出品者がまだアカウントを持っていない場合は、登録プロセスを完了します。

2. AmazonコールバックURI（前のステップでAmazonによって渡されるURI）がブラウザーにロードされ、次のパラメーターが追加されます。

   | パラメーター   | 説明                                                      |
   | :------------- | :-------------------------------------------------------- |
   | `redirect_uri` | ブラウザーをアプリケーションにリダイレクトするためのURI。 |
   | `amazon_state` | 前のステップでAmazonから渡された`amazon_state`値。        |

   |`state`|アプリケーションによって生成された状態値。アプリケーションではこの値を使用して、このリクエストとレスポンス間の状態を維持し、クロスサイトリクエストフォージェリ攻撃から保護します。**Important:** OAuth情報はURIクエリパラメーターを介して渡されるため、次の操作を行うことを強くお勧めします。 （1）状態トークンが短期間のみ有効でユーザーのみが検証可能であることを確認し、（2）`Referrer-Policy：no-referrer` HTTPヘッダーを設定し、ユーザーのウェブサイトがリンクする他ウェブサイトに機密情報を漏洩しないようにします。クロスサイトリクエストフォージェリと状態パラメーターの計算について詳しくは、Login with Amazonドキュメントの「[クロスサイトリクエストフォージェリ](https://developer.amazon.com/ja/docs/login-with-amazon/cross-site-request-forgery.html)」をご覧ください。

|

    **Note:** `version=beta`パラメーターを含めると、ワークフローでドラフト状態のアプリケーションが認可されます。このパラメーターを指定しない場合、マーケットプレイスアプリストアで公開されたアプリケーションが認可されます。
    
    たとえば、次のようになります。
    
    ```
    https://amazon.com/apps/authorize/confirm/amzn1.sellerapps.app.2eca283f-9f5a-4d13-b16c-474EXAMPLE57?redirect_uri=https://d2yzyfnnpjylxu.cloudfront.net/landing.html&amazon_state=amazonstateexample&state=-37131022&version=beta
    ```
    
    または、
    
    ```
    https://amazon.com/apps/authorize/confirm/amzn1.sellerapps.app.2eca283f-9f5a-4d13-b16c-474EXAMPLE57?redirect_uri=https://d2yzyfnnpjylxu.cloudfront.net/landing.html&amazon_state=amazonstateexample&state=-37131022
    ```


**Parent topic:** [マーケットプレイスアプリストアのワークフロー](#マーケットプレイスアプリストアのワークフロー)



### ステップ4.Amazonから認可情報が送信される

セラーセントラルに、出品者データへのアクセスが許可されていることを示すページが簡潔に表示されます。そのページが表示されている間に、次のアクションが実行されます。

1. AmazonによってリダイレクトURIがブラウザーにロードされ、次のクエリパラメーターが追加されます。

   | パラメーター         | 説明                                                         |
   | :------------------- | :----------------------------------------------------------- |
   | `state`              | 前の手順で渡した状態値。                                     |
   | `selling_partner_id` | アプリケーションを認可している出品者の出品者ID。             |
   | `mws_auth_token`     | Amazonマーケットプレイスウェブサービスを呼び出す際のクエリ文字列を作成するときに使用するMWSAuthToken値。`mws_auth_token`パラメーターは、出品者が出品パートナーAPIハイブリッドアプリケーションを認可している場合にのみ渡されます。詳しくは、「[Selling Partner APIハイブリッドアプリケーション](#Selling-Partner-APIハイブリッドアプリケーション)」をご覧ください。 |
   | `spapi_oauth_code`   | LWAリフレッシュトークンと交換するLogin with Amazon（LWA）認証コード。詳しくは、「[ステップ5.アプリケーションでLWA認証コードとLWAリフレッシュトークンを交換する](#ステップ5アプリケーションでLWA認証コードとLWAリフレッシュトークンを交換する)」をご覧ください。 |

   たとえば、次のようになります。

   ```
   https://client-example.com?state=state-example&mws_auth_token=mwsauthtokenexample&selling_partner_id=sellingpartneridexample& spapi_oauth_code=spapioauthcodeexample
   ```

2. アプリケーションによってstate値が検証されます。

3. `selling_partner_id`、`mws_auth_token`（渡された場合）、および`spapi_oauth_code`の各値が保存されます。

4. ウェブサイトのランディングページが表示されます。

**Parent topic:** [マーケットプレイスアプリストアのワークフロー](#マーケットプレイスアプリストアのワークフロー)



### ステップ5.アプリケーションでLWA認証コードとLWAリフレッシュトークンを交換する

JavaScript用のLogin with AmazonSDKは、LWA認証コードとLWAリフレッシュトークンの交換に有用です。詳しくは、Login with Amazonドキュメントをご覧ください。

-   [JavaScript用のLogin with Amazon SDKを追加する](https://developer.amazon.com/ja/docs/login-with-amazon/install-sdk-javascript.html)
-   [認証コードの付与](https://developer.amazon.com/ja/docs/login-with-amazon/authorization-code-grant.html)

**LWA認証コードとLWAリフレッシュトークンを交換するには**

1. アプリケーションでLogin with Amazon（LWA）認可サーバー（`https://api.amazon.com/auth/o2/token`）を呼び出して、LWA認証コードとLWAリフレッシュトークンを交換します。呼び出しには、次のクエリパラメーターを含める必要があります。

   | パラメーター    | 説明                                                         |
   | :-------------- | :----------------------------------------------------------- |
   | `grant_type`    | 要求されるアクセス許可のタイプ。authorization\_codeである必要があります。 |
   | `code`          | [ステップ4.Amazonから認可情報が送信される](#ステップ4Amazonから認可情報が送信される)で受け取ったLWA認証コード。 |
   | `redirect_uri`  | アプリケーションのリダイレクトURI。                          |
   | `client_id`     | LWA認証情報の一部。この値を取得するには、「[開発者情報の表示](#開発者情報の表示)」をご覧ください。 |
   | `client_secret` | LWA認証情報の一部。この値を取得するには、「[開発者情報の表示](#開発者情報の表示)」をご覧ください。 |

   たとえば、次のようになります。

   ```
   POST /auth/o2/token HTTP/l.l
   Host: api.amazon.com
   Content-Type: application/x-www-form-urlencoded;charset=UTF-8
   grant_type=authorization_code&code=SplxlOexamplebYS6WxSbIA&client_id=foodev&client_secret=Y76SDl2F
   ```

2. LWA認可サーバーからLWAリフレッシュトークンが返されます。レスポンスはJSON形式で、次の要素が含まれます。

   | パラメーター    | 説明                                                         |
   | :-------------- | :----------------------------------------------------------- |
   | `access_token`  | 出品者に代わってアプリケーションが特定のアクションを実行することを許可するトークン。「[出品パートナーAPIへの接続](#出品パートナーAPIへの接続)」をご覧ください。 |
   | `token_type`    | 返されるトークンのタイプ。`ベアラー`である必要があります。   |
   | `expires_in`    | アクセストークンが無効になるまでの秒数。                     |
   | `refresh_token` | 新しいアクセストークンと交換できる長期間有効なトークン。「[出品パートナーAPIへの接続](#出品パートナーAPIへの接続)」をご覧ください。 |

   ```
   HTTP/l.l 200 OK
   Content-Type: application/json;charset UTF-8
   Cache-Control: no-store
   Pragma: no-cache
   {
       "access_token":"Atza|IQEBLjAsAexampleHpi0U-Dme37rR6CuUpSR",
       "token_type":"bearer",
       "expires_in":3600,
       "refresh_token":"Atzr|IQEBLzAtAhexamplewVz2Nn6f2y-tpJX2DeX"
   }
   ```

3. `refresh_token`値が保存されます。

4. ブラウザーにアプリケーションを使用するための次のステップを示すページが表示されます。

LWAリフレッシュトークンは、LWAアクセストークンと交換する長期間有効なトークンです。このトークンは、出品パートナーAPIへのすべてのリクエストに含める必要があります。アクセストークンは発行から1時間有効です。有効期限が切れるまでは、複数のAPI呼び出しで同じアクセストークンを使用できます。「[出品パートナーAPIへの接続](#出品パートナーAPIへの接続)」をご覧ください。

これで、開発者のアプリケーションが出品者に代わって出品パートナーAPIを呼び出すことが認可されました。

**Selling Partner APIハイブリッドアプリケーションの場合**

MWS認可トークンが[ステップ4.Amazonから認可情報が送信される](#ステップ4Amazonから認可情報が送信される)で返された場合、出品者に代わってAmazonマーケットプレイスウェブサービスへの呼び出しを行う権限も付与されます。詳しくは、「[出品パートナーAPIハイブリッドアプリケーション](#出品パートナーAPIハイブリッドアプリケーション)」をご覧ください。

**Parent topic:** [マーケットプレイスアプリストアのワークフロー](#マーケットプレイスアプリストアのワークフロー)



## ウェブサイトワークフロー

ウェブサイトワークフローは、自分のウェブサイトから開始されるOAuth認可ワークフローです。出品者が開発者のウェブサイトにサインインし、認可を開始するために開発者が設定した「認可」ボタンをクリックします。詳しくは、「[ステップ0.OAuth認可URIを設定する](#ステップ0OAuth認可URIを設定する)」をご覧ください。

このトピックには、ウェブサイトワークフローの手順と、ワークフローのテストに関する情報が含まれています。

### ウェブサイトワークフローのテスト

実稼働のウェブサイトのワークフローを作成する前に、アプリケーションをドラフト状態で認可できるテストワークフローを作成することが重要です。これにより、アプリケーションがAmazonとパラメーターを交換し、認可情報を受け取ることができるかどうかをテストできます。

テストワークフローと実稼働ワークフローの違いは次のとおりです。

-   アプリケーションにより、`version=beta`パラメーターが[ステップ1.ウェブサイトから認可を開始する](#ステップ1ウェブサイトから認可を開始する)のOAuth認可URIに追加されます。これにより、ワークフローでアプリケーションがドラフト状態で認可されます。

ワークフローのテストが完了したら、`version=beta`パラメーターが[ステップ1.ウェブサイトから認可を開始する](#ステップ1ウェブサイトから認可を開始する)のOAuth認可URIに追加されないよう、ワークフローを更新します。これにより、実稼動ワークフローとなります。これで、すべての出品者が自分のウェブサイトから公開アプリケーションを認可できるようになりました。

実稼動ワークフローが、[ステップ0.OAuth認可URIを設定する](#ステップ0OAuth認可URIを設定する)で始まります。

-   **[ステップ0.OAuth認可URIを設定する](#ステップ0OAuth認可URIを設定する)**  

-   **[ステップ1.ウェブサイトから認可を開始する](#ステップ1ウェブサイトから認可を開始する)**  

-   **[ステップ2.出品者がアプリケーションの認可に同意する](#ステップ2出品者がアプリケーションの認可に同意する)**  

-   **[ステップ3.Amazonから認可情報が送信される](#ステップ3Amazonから認可情報が送信される)**  

-   **[ステップ4.アプリケーションでLWA認証コードとLWAリフレッシュトークンを交換する](#ステップ4アプリケーションでLWA認証コードとLWAリフレッシュトークンを交換する)**  


**Parent topic:** [Selling Partner APIアプリケーションの認可](#Selling-Partner-APIアプリケーションの認可)



### ステップ0.OAuth認可URIを設定する

出品者がクリックしてアプリケーションの認可を開始できるよう、アプリケーションウェブサイトに「認可」ボタン（または同様のボタン）を設定します。出品者がボタンをクリックすると、開発者のウェブサイトでOAuth認可URIがブラウザーに読み込まれ、セラーセントラルのサインインページにリダイレクトされます。OAuth認可URIの取得については、「[ステップ4.アプリケーション登録情報を提供する](#ステップ4アプリケーション登録情報を提供する)」をご覧ください。

**複数リージョンのOAuth認可URI**

複数リージョンにOAuth認可URIがある場合は、出品者が自分のリージョンのセラーセントラルサインインページにリダイレクトされるよう、「認可」ボタンを設定してください。複数リージョンのURIの取得について詳しくは、「[ステップ4.アプリケーション登録情報を提供する](#ステップ4アプリケーション登録情報を提供する)」をご覧ください。

「認可」ボタンの設定は、1回限りの作業です。

**Parent topic:** [ウェブサイトワークフロー](#ウェブサイトワークフロー)



### ステップ1.ウェブサイトから認可を開始する

1. 出品者が開発者のウェブサイトにサインインします。まだアカウントを持っていない場合は、登録プロセスを完了します。

2. 開発者が[ステップ0.OAuth認可URIを設定する](#ステップ0OAuth認可URIを設定する)で設定した「認可」ボタンを出品者がクリックします。複数リージョンで「認可」ボタンがある場合は、出品するリージョンに対応したボタンが表示されていることを確認してください。

3. OAuth認可URIがブラウザーにロードされ、次のクエリパラメーターが追加されます。

   |パラメーター|説明|
   |:-----|:-|
   |`state` |アプリケーションによって生成された状態値。アプリケーションではこの値を使用して、このリクエストとレスポンス間の状態を維持し、クロスサイトリクエストフォージェリ攻撃から保護します。**Important:** OAuth情報はURLクエリパラメーターを介して渡されるため、次の操作を行うことを強くお勧めします。 （1）状態トークンが短期間のみ有効でユーザーのみが検証可能であることを確認し、（2）`Referrer-Policy：no-referrer` HTTPヘッダーを設定し、ユーザーのウェブサイトがリンクする他ウェブサイトに機密情報を漏洩しないようにします。クロスサイトリクエストフォージェリと状態パラメーターの計算について詳しくは、Login with Amazonドキュメントの「[クロスサイトリクエストフォージェリ](https://developer.amazon.com/ja/docs/login-with-amazon/cross-site-request-forgery.html)」をご覧ください。

|

    **Note:** `version=beta`パラメーターを含めると、ワークフローでドラフト状態のアプリケーションが認可されます。このパラメーターを指定しない場合、マーケットプレイスアプリストアで公開されたアプリケーションが認可されます。
    
    たとえば、次のようになります。
    
    ```
    https://sellercentral.amazon.com/apps/authorize/consent?application_id=appidexample&state=stateexample&version=beta
    ```
    
    または、
    
    ```
    https://sellercentral.amazon.com/apps/authorize/consent?application_id=appidexample&state=stateexample
    ```
    
    セラーセントラルのサインインページにアクセスします。


**Parent topic:** [ウェブサイトワークフロー](#ウェブサイトワークフロー)



### ステップ2.出品者がアプリケーションの認可に同意する

1. 出品者がセラーセントラルにサインインします。

   同意ページが表示されます。

2. 同意ページが表示されたら、出品者はアプリケーションによって要求されたデータアクセスを確認し、「**確認**」ボタンをクリックして続行します。「**キャンセル**」ボタンをクリックして、認可せずに終了することもできます。

**Parent topic:** [ウェブサイトワークフロー](#ウェブサイトワークフロー)



### ステップ3.Amazonから認可情報が送信される

セラーセントラルに、出品者データへのアクセスが許可されていることを示すページが簡潔に表示されます。そのページが表示されている間に、次のアクションが実行されます。

1. AmazonによってリダイレクトURIがブラウザーにロードされ、次のクエリパラメーターが追加されます。

   | パラメーター         | 説明                                                         |
   | :------------------- | :----------------------------------------------------------- |
   | `state`              | 状態値。「[ステップ1.ウェブサイトから認可を開始する](#ステップ1ウェブサイトから認可を開始する)」をご覧ください。 |
   | `selling_partner_id` | アプリケーションを認可している出品者の出品者ID。             |
   | `mws_auth_token`     | Amazonマーケットプレイスウェブサービスを呼び出す際のクエリ文字列を作成するときに使用するMWSAuthToken値。`mws_auth_token`パラメーターは、出品者が出品パートナーAPIハイブリッドアプリケーションを認可している場合にのみ渡されます。詳しくは、「[Selling Partner APIハイブリッドアプリケーション](#Selling-Partner-APIハイブリッドアプリケーション)」をご覧ください。 |
   | `spapi_oauth_code`   | LWAリフレッシュトークンと交換するLogin with Amazon（LWA）認証コード。詳しくは、「[ステップ4.アプリケーションでLWA認証コードとLWAリフレッシュトークンを交換する](#ステップ4アプリケーションでLWA認証コードとLWAリフレッシュトークンを交換する)」をご覧ください。 |

   たとえば、次のようになります。

   ```
   https://client-example.com?state=state-example&mws_auth_token=mwsauthtokenexample&selling_partner_id=sellingpartneridexample& spapi_oauth_code=spapioauthcodeexample
   ```

2. アプリケーションによってstate値が検証されます。

3. `selling_partner_id`、`mws_auth_token`（渡された場合）、および`spapi_oauth_code`の各値が保存されます。

4. ウェブサイトのランディングページが表示されます。

**Parent topic:** [ウェブサイトワークフロー](#ウェブサイトワークフロー)



### ステップ4.アプリケーションでLWA認証コードとLWAリフレッシュトークンを交換する

JavaScript用のLogin with AmazonSDKは、LWA認証コードとLWAリフレッシュトークンの交換に有用です。詳しくは、Login with Amazonドキュメントをご覧ください。

-   [JavaScript用のLogin with Amazon SDKを追加する](https://developer.amazon.com/ja/docs/login-with-amazon/install-sdk-javascript.html)
-   [認証コードの付与](https://developer.amazon.com/ja/docs/login-with-amazon/authorization-code-grant.html)

**LWA認証コードとLWAリフレッシュトークンを交換するには**

1. アプリケーションでLogin with Amazon（LWA）認可サーバー（`https://api.amazon.com/auth/o2/token`）を呼び出して、LWA認証コードとLWAリフレッシュトークンを交換します。呼び出しには、次のクエリパラメーターを含める必要があります。

   | パラメーター    | 説明                                                         |
   | :-------------- | :----------------------------------------------------------- |
   | `grant_type`    | 要求されるアクセス許可のタイプ。authorization\_codeである必要があります。 |
   | `code`          | [ステップ3.Amazonから認可情報が送信される](#ステップ3Amazonから認可情報が送信される)で受け取ったLWA認証コード。 |
   | `redirect_uri`  | アプリケーションのリダイレクトURI。                          |
   | `client_id`     | LWA認証情報の一部。この値を取得するには、「[開発者情報の表示](#開発者情報の表示)」をご覧ください。 |
   | `client_secret` | LWA認証情報の一部。この値を取得するには、「[開発者情報の表示](#開発者情報の表示)」をご覧ください。 |

   たとえば、次のようになります。

   ```
   POST /auth/o2/token HTTP/l.l
   Host: api.amazon.com
   Content-Type: application/x-www-form-urlencoded;charset=UTF-8
   grant_type=authorization_code&code=SplxlOexamplebYS6WxSbIA&client_id=foodev&client_secret=Y76SDl2F
   ```

2. LWA認可サーバーからLWAリフレッシュトークンが返されます。レスポンスはJSON形式で、次の要素が含まれます。

   | パラメーター    | 説明                                                         |
   | :-------------- | :----------------------------------------------------------- |
   | `access_token`  | 出品者に代わってアプリケーションが特定のアクションを実行することを許可するトークン。「[出品パートナーAPIへの接続](#出品パートナーAPIへの接続)」をご覧ください。 |
   | `token_type`    | 返されるトークンのタイプ。`ベアラー`である必要があります。   |
   | `expires_in`    | アクセストークンが無効になるまでの秒数。                     |
   | `refresh_token` | 新しいアクセストークンと交換できる長期間有効なトークン。「[出品パートナーAPIへの接続](#出品パートナーAPIへの接続)」をご覧ください。 |

   ```
   HTTP/l.l 200 OK
   Content-Type: application/json;charset UTF-8
   Cache-Control: no-store
   Pragma: no-cache
   {
       "access_token":"Atza|IQEBLjAsAexampleHpi0U-Dme37rR6CuUpSR",
       "token_type":"bearer",
       "expires_in":3600,
       "refresh_token":"Atzr|IQEBLzAtAhexamplewVz2Nn6f2y-tpJX2DeX"
   }
   ```

3. `refresh_token`値が保存されます。

4. ブラウザーにアプリケーションを使用するための次のステップを示すページが表示されます。

LWAリフレッシュトークンは、LWAアクセストークンと交換する長期間有効なトークンです。このトークンは、出品パートナーAPIへのすべてのリクエストに含める必要があります。アクセストークンは発行から1時間有効です。有効期限が切れるまでは、複数のAPI呼び出しで同じアクセストークンを使用できます。「[出品パートナーAPIへの接続](#出品パートナーAPIへの接続)」をご覧ください。

これで、開発者のアプリケーションが出品者に代わって出品パートナーAPIを呼び出すことが認可されました。

**Selling Partner APIハイブリッドアプリケーションの場合**

MWS認可トークンが[ステップ3.Amazonから認可情報が送信される](#ステップ3Amazonから認可情報が送信される)で返された場合、出品者に代わってAmazonマーケットプレイスウェブサービスへの呼び出しを行う権限も付与されます。詳しくは、「[出品パートナーAPIハイブリッドアプリケーション](#出品パートナーAPIハイブリッドアプリケーション)」をご覧ください。

**Parent topic:** [ウェブサイトワークフロー](#ウェブサイトワークフロー)



# 自己認可

デベロッパーセントラルでアプリケーションを自己認可できます。これを行う前に、「[出品パートナーAPIアプリケーションの登録](#出品パートナーAPIアプリケーションの登録)」の手順を実行する必要があります。

完全なOAuth認可ワークフローを実装するには、「[Selling Partner APIアプリケーションの認可](#Selling-Partner-APIアプリケーションの認可)」をご覧ください。

**アプリケーションを自己認可するには**

1. [ステップ4.アプリケーション登録情報を提供する](#ステップ4アプリケーション登録情報を提供する)で入力した出品者IDに関連付けられているリージョンのデベロッパーセントラルに移動します。

   -   北米：[https://sellercentral.amazon.com/sellingpartner/developerconsole](https://sellercentral.amazon.com/sellingpartner/developerconsole)
   -   ヨーロッパ：[https://sellercentral.amazon.co.uk/sellingpartner/developerconsole](https://sellercentral.amazon.co.uk/sellingpartner/developerconsole)
   -   極東地域：[https://sellercentral.amazon.co.jp/sellingpartner/developerconsole](https://sellercentral.amazon.co.jp/sellingpartner/developerconsole)

2. 前の手順の出品者IDの認証情報を使用してサインインします。

   「**デベロッパーセントラル**」ページが表示されます。

3. 「**編集**」をクリックし、認可するアプリケーションの横にある「**認可**」をクリックします。

   「**リフレッシュトークンを生成**」ボタンを含むページが表示されます。

4. 「**リフレッシュトークンを生成**」をクリックします。

   Login with Amazon（LWA）リフレッシュトークンが表示されます。これで、出品用アカウントへのアクセスが認可されました。


**Important:** 「**リフレッシュトークンを生成**」をクリックしてリフレッシュトークンを取得し、それを保存してSelling Partner APIを呼び出します。「**リフレッシュトークンを生成**」を複数回クリックすると、毎回新しいリフレッシュトークンが取得され、以前のリフレッシュトークンが無効になります。

リフレッシュトークンは、短期間のアクセストークンと交換する長期間有効なトークンです。Selling Partner APIへのすべてのリクエストには、アクセストークンを含める必要があります。アクセストークンは発行から1時間有効です。有効期限が切れるまでは、複数のAPI呼び出しで同じアクセストークンを使用できます。詳しくは、「[ステップ1.Login with Amazonアクセストークンをリクエストする](#ステップ1Login-with-Amazonアクセストークンをリクエストする)」をご覧ください。



# LWAトークンの交換と認証を使用したJava SDKの生成

以下の手順では、Microsoft Windowsを実行しているコンピューターで、[Swagger Code Generator](https://github.com/swagger-api/swagger-codegen)を使用して出品者API用のJava SDKを生成する方法を説明します。このプロセスは、macOSやLinuxなどの他のオペレーティングシステムのユーザーでも、Windows固有のセマンティクス（C:\\など）を置き換えることで応用できます。この手順は出品者API用ですが、Selling Partner APIで他のAPI用のSDKを作成する手順を変更できます。Selling Partner APIセクションごとのSwaggerモデルについては、Selling Partner API GitHubリポジトリをご覧ください。

このSDKを使用すると、すでにセットアップされている次のコードを使用して、出品者APIを呼び出すことができます。 Login with Amazonのトークン交換（リフレッシュトークンとアクセストークンの交換）と認証。

**LWAトークン交換と認証を使用してJava SDKを生成するには**

1. [Java 8以降](https://www.oracle.com/technetwork/java/index.html)、[Apache Maven 3.6](http://maven.apache.org)以降、[GNU Wget](https://www.gnu.org/software/wget/wget.html)をインストールし、`$PATH`で利用できるようにします。

2. [github.com/amzn](https://github.com/amzn)にサインインします。

3. 「amazon-marketplace-api-sdk」を検索し、表示される**amazon-marketplace-api-sdk**リンクをクリックします。

4. **Sellers API/Sellers.json**ファイルをダウンロードします。

5. **clients/sellingpartner-api-aa-java**フォルダをダウンロードします。このフォルダには、認可および認証ライブラリと、Swagger Code Generator用のカスタマイズされたテンプレートが含まれています。

6. コマンドプロンプトウィンドウを開き、Swagger Code Generatorをダウンロードするディレクトリに移動します。

7. Swagger Code Generatorの最新バージョンをダウンロードします。

   たとえば、次のようになります。

   ```
   wget https://repo1.maven.org/maven2/io/swagger/swagger-codegen-cli/2.4.13/swagger-codegen-cli-2.4.13.jar -O swagger-codegen-cli.jar
   ```

   **swagger-codegen-cli.jar**が現在のディレクトリにダウンロードされます。

   **Note:** また、ブラウザーで以下を指示することで、maven.orgからダウンロードすることができます：[https://repo1.maven.org/maven2/io/swagger/swagger-codegen-cli/2.4.13/swagger-codegen-cli-2.4.13.jar](https://repo1.maven.org/maven2/io/swagger/swagger-codegen-cli/2.4.13/swagger-codegen-cli-2.4.13.jar)

8. **Sellers.json**と**swagger-codegen-cli.jar**をディレクトリ構造にコピーすると、わかりやすくなります。この例では、`C:\SwaggerToCL`にコピーします。

9. **clients/sellingpartner-api-aa-java**フォルダ内のテンプレートに対してSDKを生成します。

   たとえば、次のようになります。

   ```
   java -jar C:\SwaggerToCL\swagger-codegen-cli.jar generate -i  C:\SwaggerToCL\Sellers.json -l java -t [path to clients\sellingpartner-api-aa-java directory]/resources/swagger-codegen/templates/ -o  C:\SwaggerToCL\Sellers_JavaCL
   ```

   SDKが、`C:\SwaggerToCL\Sellers_JavaCL`にコピーされます。

10. AAライブラリを構築し、SDKの依存関係として追加します。

    1. **clients/sellingpartner-api-aa-java**フォルダに移動し、`mvnパッケージ`を実行します。これにより、「target」という名前のフォルダが生成されます。このフォルダには、**sellingpartnerapi-aa-java-1.0-jar-with-dependencies.jar**（または類似のもの）という名前のJARファイルと、必要なすべての依存関係が含まれます。

    2. JARファイルをローカルのMavenリポジトリにインストールします。

       たとえば、次のようになります。

       ```
       mvn install:install-file -Dfile=[path to JAR file in "target" folder] -DgroupId=com.amazon.sellingpartnerapi -DartifactId=sellingpartnerapi-aa-java -Dversion=1.0 -Dpackaging=jar
       ```

       実際の`groupId`、`artifactId`、および`version`値は、**clients/sellingpartner-api-aa-java**フォルダ内の**pom.xml**ファイルの上部付近にあります。

    3. クライアントライブラリの**pom.xml**にAAライブラリへの依存関係を追加します。

       たとえば、次のようになります。

       ```
       <dependency>
         <groupId>com.amazon.sellingpartnerapi</groupId>
         <artifactId>sellingpartnerapi-aa-java</artifactId>
         <version>1.0</version>
       </dependency>
       ```


SDKを生成したら、それを使用してSelling Partner APIを呼び出すことができます。「[生成されたJava SDKを使用したSelling Partner APIへの接続](#生成されたJava-SDKを使用したSelling-Partner-APIへの接続)」をご覧ください。



# 生成されたJava SDKを使用したSelling Partner APIへの接続

開発者のアプリケーションをSelling Partner APIに接続するには、アプリケーションを登録し、登録したアプリケーションを出品者に認可してもらう必要があります。「[出品パートナーAPIアプリケーションの登録](#出品パートナーAPIアプリケーションの登録)」および「[Selling Partner APIアプリケーションの認可](#Selling-Partner-APIアプリケーションの認可)」をご覧ください。

以下の手順では、生成されたJava SDKを使用してSelling Partner APIを呼び出す方法について説明します。SDKは、LWAおよびAWS認証情報を設定するためのクラスを公開し、これらを使用してLWAトークンを交換し、リクエストに署名します。詳しくは、「[LWAトークンの交換と認証を使用したJava SDKの生成](#LWAトークンの交換と認証を使用したJava-SDKの生成)」をご覧ください。

## ステップ1.AWS認証情報の設定

以下のパラメーターを使用して、`AWSAuthenticationCredentials`インスタンスを作成します。

| 名前          | 説明                                                         | 必須 |
| :------------ | :----------------------------------------------------------- | ---- |
| `accessKeyId` | AWSのアクセスキーID。詳しくは、「[ステップ3.IAMユーザーを作成する](#ステップ3IAMユーザーを作成する)」をご覧ください。 | はい |
| `secretKey`   | AWSの秘密キー。詳しくは、「[ステップ3.IAMユーザーを作成する](#ステップ3IAMユーザーを作成する)」をご覧ください。 | はい |
| `region`      | 呼び出しを指示しているAWSリージョン。詳しくは、「[出品パートナーAPIエンドポイント](#出品パートナーAPIエンドポイント)」をご覧ください。 | はい |

たとえば、次のようになります。

```
import com.amazon.SellingPartnerAPIAA.AWSAuthenticationCredentials;

...

AWSAuthenticationCredentials awsAuthenticationCredentials=AWSAuthenticationCredentials.builder()
  .accessKeyId("myAccessKeyId")
  .secretKey("mySecretId")
  .region("us-east-1")
  .build();
```

## ステップ2.LWA認証情報の設定

以下のパラメーターを使用して、`LWAAuthorizationCredentials`インスタンスを作成します。

| 名前           | 説明                                                         | 必須 |
| :------------- | :----------------------------------------------------------- | ---- |
| `clientId`     | LWAのクライアントID。詳しくは、「[開発者情報の表示](#開発者情報の表示)」をご覧ください。 | はい |
| `clientSecret` | LWAのクライアントシークレット。詳しくは、「[開発者情報の表示](#開発者情報の表示)」をご覧ください。 | はい |
| `refreshToken` | LWAのリフレッシュトークン。出品者がアプリケーションを認可したときにこの値を取得します。詳しくは、「[Selling Partner APIアプリケーションの認可](#Selling-Partner-APIアプリケーションの認可)」をご覧ください。 | はい |
| `endpoint`     | LWA認証サーバーのURI。                                       | はい |

たとえば、次のようになります。

```
import com.amazon.SellingPartnerAPIAA.LWAAuthorizationCredentials;

...

LWAAuthorizationCredentials lwaAuthorizationCredentials = LWAAuthorizationCredentials.builder()
  .clientId("myClientId")
  .clientSecret("myClientSecret")
  .refreshToken("Aztr|...")
  .endpoint("https://api.amazon.com/auth/o2/token")
  .build();
```

## ステップ3.出品者APIのインスタンスを作成し、オペレーションを呼び出す

`AWSAuthenticationCredentials`インスタンスと`LWAAuthorizationCredentials`インスタンスを設定すると、`SellersApi`インスタンスを作成してオペレーションを呼び出すことができます。

たとえば、次のようになります。

```
SellersApi sellersApi = new SellersApi.Builder()
  .awsAuthenticationCredentials(awsAuthenticationCredentials)
  .lwaAuthorizationCredentials(lwaAuthorizationCredentials)
  .endpoint(https://sellingpartnerapi-na.amazon.com)
  .build();
sellersApi.getMarketplaceParticipations();
```



# Javaクライアントライブラリの生成

以下の手順では、Microsoft Windowsを実行しているコンピューターで、[Swagger Code Generator](https://github.com/swagger-api/swagger-codegen)を使用して出品者API用のJavaクライアントライブラリを生成する方法を説明します。このプロセスは、macOSやLinuxなどの他のオペレーティングシステムのユーザーでも、Windows固有のセマンティクス（C:\\など）を置き換えることで応用できます。この手順は出品者API用ですが、Selling Partner APIで他のAPI用のクライアントライブラリを作成する手順を変更できます。Selling Partner APIセクションごとのSwaggerモデルについては、Selling Partner API GitHubリポジトリをご覧ください。

生成されたクライアントライブラリは、Selling Partner APIを呼び出すのに有用ですが、LWAトークンの交換と認証のためのコードは含まれていません。それについては、「[ステップ1.Login with Amazonアクセストークンをリクエストする](#ステップ1Login-with-Amazonアクセストークンをリクエストする)」および「[ステップ4.リクエストの作成と署名](#ステップ4リクエストの作成と署名)」をご覧ください。または、LWAトークンの交換と認証を含むSDKについては、「[LWAトークンの交換と認証を使用したJava SDKの生成](#LWAトークンの交換と認証を使用したJava-SDKの生成)」をご覧ください。

**Javaクライアントライブラリを生成するには** 

1. [Java 8以降](https://www.oracle.com/technetwork/java/index.html)、[Apache Maven 3.6](http://maven.apache.org)以降、[GNU Wget](https://www.gnu.org/software/wget/wget.html)をインストールし、`$PATH`で利用できるようにします。

2. [github.com/amzn](https://github.com/amzn)にサインインします。

3. 「amazon-marketplace-api-sdk」を検索し、表示される**amazon-marketplace-api-sdk**リンクをクリックします。

4. **Sellers API/Sellers.json**ファイルをダウンロードします。

5. コマンドプロンプトウィンドウを開き、Swagger Code Generatorをダウンロードするディレクトリに移動します。

6. Swagger Code Generatorの最新バージョンをダウンロードします。

   たとえば、次のようになります。

   ```
   wget https://repo1.maven.org/maven2/io/swagger/swagger-codegen-cli/2.4.13/swagger-codegen-cli-2.4.13.jar -O swagger-codegen-cli.jar
   ```

   **swagger-codegen-cli.jar**が現在のディレクトリにダウンロードされます。

   **Note:** また、ブラウザーで以下を指示することで、maven.orgからダウンロードすることができます：[https://repo1.maven.org/maven2/io/swagger/swagger-codegen-cli/2.4.13/swagger-codegen-cli-2.4.13.jar](https://repo1.maven.org/maven2/io/swagger/swagger-codegen-cli/2.4.13/swagger-codegen-cli-2.4.13.jar)

7. **Sellers.json**と**swagger-codegen-cli.jar**をディレクトリ構造にコピーすると、わかりやすくなります。この例では、`C:\SwaggerToCL`にコピーします。

8. クライアントライブラリを生成します。

   たとえば、次のようになります。

   ```
   java -jar C:\SwaggerToCL\swagger-codegen-cli.jar generate -i C:\SwaggerToCL\Sellers.json -l java -o C:\SwaggerToCL\Sellers_JavaCL
   ```

   クライアントライブラリが、`C:\SwaggerToCL\Sellers_JavaCL`にコピーされます。


クライアントライブラリを生成したら、それを使用してSelling Partner APIを呼び出すことができます。「[出品パートナーAPIへの接続](#出品パートナーAPIへの接続)」をご覧ください。



# 出品パートナーAPIへの接続

開発者のアプリケーションをSelling Partner APIに接続するには、アプリケーションを登録し、登録したアプリケーションを出品者に認可してもらう必要があります。「[出品パートナーAPIアプリケーションの登録](#出品パートナーAPIアプリケーションの登録)」および「[Selling Partner APIアプリケーションの認可](#Selling-Partner-APIアプリケーションの認可)」をご覧ください。

以下では、Selling Partner APIを呼び出す手順を説明します。Selling Partner APIのURIを作成してヘッダーを追加する方法については、「[Javaクライアントライブラリの生成](#Javaクライアントライブラリの生成)」をご覧ください。LWAトークンと認証を交換するためのコードなど、より詳細なソリューションについては、「[LWAトークンの交換と認証を使用したJava SDKの生成](#LWAトークンの交換と認証を使用したJava-SDKの生成)」をご覧ください。

-   **[ステップ1.Login with Amazonアクセストークンをリクエストする](#ステップ1Login-with-Amazonアクセストークンをリクエストする)**  

-   **[ステップ2.出品パートナーAPI URIを構築する](#ステップ2出品パートナーAPI-URIを構築する)**  

-   **[ステップ3.URIにヘッダーを追加する](#ステップ3URIにヘッダーを追加する)**  

-   **[ステップ4.リクエストの作成と署名](#ステップ4リクエストの作成と署名)**  



## ステップ1.Login with Amazonアクセストークンをリクエストする

Login with Amazon（LWA）アクセストークンによって、出品者に代わってアプリケーションが特定のアクションを実行することが認可されます。LWAアクセストークンは発行後1時間で失効し、また、出品パートナーAPIへのリクエストごとに含める必要があります。

LWAアクセストークンをリクエストするには、次のパラメーターを使用して、LWA認証サーバー（`https://api.amazon.com/auth/o2/token`）に安全な`HTTP POST`を実行します。

| 名前            | 説明                                                         | 必須 |
| :-------------- | :----------------------------------------------------------- | ---- |
| `grant_type`    | 要求されるアクセス許可のタイプ。refresh\_tokenである必要があります。 | はい |
| `refresh_token` | 出品者がアプリケーションを認可したときにこの値を取得します。詳しくは、「[Selling Partner APIアプリケーションの認可](#Selling-Partner-APIアプリケーションの認可)」をご覧ください。 | はい |
| `client_id`     | アプリケーションを登録するときにこの値を取得します。「[開発者情報の表示](#開発者情報の表示)」をご覧ください。 | はい |
| `client_secret` | アプリケーションを登録するときにこの値を取得します。「[開発者情報の表示](#開発者情報の表示)」をご覧ください。 | はい |

たとえば、次のようになります。

```
POST /auth/o2/token HTTP/l.l
Host: api.amazon.com
Content-Type: application/x-www-form-urlencoded;charset=UTF-8

grant_type=refresh_token
&refresh_token=Atzr|IQEBLzAtAhRPpMJxdwVz2Nn6f2y-tpJX2DeX...
&client_id=foodev
&client_secret=Y76SDl2F
```

**Tip:** LWA認可サーバーを呼び出すときに信頼されていない認証機関（CA）エラーが発生しないようにするには、LWA認可サーバーが信頼されるよう、信頼できるストアを更新してください。

**レスポンス**

成功レスポンスには、次の値が含まれます。

| 名前            | 説明                                                         |
| :-------------- | :----------------------------------------------------------- |
| `access_token`  | LWAアクセストークン。最大サイズ： `2048バイト`。             |
| `token_type`    | 返されるトークンのタイプ。ベアラーである必要があります。     |
| `expires_in`    | LWAアクセストークンが無効になるまでの秒数。                  |
| `refresh_token` | リクエストで送信されたLWAアクセストークン。最大サイズ： `2048バイト`。 |

```
HTTP/l.l 200 OK
Content-Type: application/json;charset UTF-8
Cache-Control: no-store
Pragma: no-cache
{
    "access_token":"Atza|IQEBLjAsAhRmHjNgHpi0U-Dme37rR6CuUpSREXAMPLE",
    "token_type":"bearer",
    "expires_in":3600,
    "refresh_token":"Atzr|IQEBLzAtAhRPpMJxdwVz2Nn6f2y-tpJX2DeXEXAMPLE"
}
```

詳しくは、Login with Amazonドキュメントの「[認証コードの付与](https://developer.amazon.com/ja/docs/login-with-amazon/authorization-code-grant.html)」ページをご覧ください。

**Parent topic:** [出品パートナーAPIへの接続](#出品パートナーAPIへの接続)



## ステップ2.出品パートナーAPI URIを構築する

以下は、出品パートナーAPIURIの構成要素です。

| 名前           | 説明                                                         | 例                                        |
| :------------- | :----------------------------------------------------------- | :---------------------------------------- |
| HTTPメソッド   | [出品パートナーAPI HTTPメソッド](#出品パートナーAPI-HTTPメソッド)の1つ。 | `GET`                                     |
| エンドポイント | [出品パートナーAPIエンドポイント](#出品パートナーAPIエンドポイント)。 | `https://sellingpartnerapi-na.amazon.com` |
| パス           | 出品パートナーAPIセクション/バージョン。セクション/リソースの番号。 | `/sellers/v1/marketplaceParticipations`   |
| クエリ文字列   | クエリパラメーター。                                         | `?marketplace=ATVPDKIKX0DER`              |

たとえば、次のようになります。

```
GET https://https://sellingpartnerapi-na.amazon.com/sellers/v1/marketplaceParticipations?marketplace=ATVPDKIKX0DER
```

**Parent topic:** [出品パートナーAPIへの接続](#出品パートナーAPIへの接続)



## ステップ3.URIにヘッダーを追加する

[ステップ2.出品パートナーAPI URIを構築する](#ステップ2出品パートナーAPI-URIを構築する)で作成したURIにヘッダーを追加します。

以下は、出品パートナーAPIへのリクエストに含めるHTTPヘッダーです。

**リクエストヘッダー**

| 名前                 | 説明                                                         |
| :------------------- | :----------------------------------------------------------- |
| `host`               | マーケットプレイスのエンドポイント。「[出品パートナーAPI HTTPメソッド](#出品パートナーAPI-HTTPメソッド)」をご覧ください。 |
| `x-amz-access-token` | LWAアクセストークン。「[ステップ1.Login with Amazonアクセストークンをリクエストする](#ステップ1Login-with-Amazonアクセストークンをリクエストする)」をご覧ください。 |
| `x-amz-date`         | リクエストの日時。                                           |
| `user-agent`         | アプリケーション名とバージョン番号、プラットフォーム、プログラミング言語。これらの情報は、Amazonがサービスで発生する可能性のある問題を診断し、解決する際に役立ちます。「[すべてのリクエストにUser-Agentヘッダーパラメーターを含める](#すべてのリクエストにUser-Agentヘッダーパラメーターを含める)」をご覧ください。 |

以下は、URIとヘッダーはあるが署名情報がないSelling Partner APIへのリクエストの例です。

```
GET https://sellingpartnerapi-na.amazon.com/sellers/v1/marketplaceParticipations?marketplace=ATVPDKIKX0DER HTTP/1.1
host: sellingpartnerapi-na.amazon.com
user-agent: My Selling Tool/2.0 (Language=Java/1.8.0.221; Platform=Windows/10)
x-amz-access-token=Atza|IQEBLjAsAhRmHjNgHpi0U-Dme37rR6CuUpSREXAMPLE
x-amz-date: 20190430T123600Z
```

出品パートナーAPIへのリクエストに署名するには、「[ステップ4.リクエストの作成と署名](#ステップ4リクエストの作成と署名)」をご覧ください。

**Parent topic:** [出品パートナーAPIへの接続](#出品パートナーAPIへの接続)



## ステップ4.リクエストの作成と署名

出品パートナーAPIでは、リクエストの認証にAWS[署名バージョン4署名プロセス](#署名バージョン4署名プロセス)が使用されます。HTTPリクエストを出品パートナーAPIに送信する際に、リクエストに署名して、Amazonがリクエストを送信したユーザーを特定できるようにします。アクセスキーIDと秘密キーで構成されるAWSアクセスキーを使用して、リクエストに署名します。AWSアクセスキーの取得については、「[ステップ3.IAMユーザーを作成する](#ステップ3IAMユーザーを作成する)」をご覧ください。

**Note:** 手動でHTTPリクエストを作成する場合に限り、HTTPリクエストの署名方法について学ぶ必要があります。いずれかのAWS SDKを使用して署名を計算すると、設定時に指定したAWSアクセスキーを使用して、SDKによってリクエストに自動的に署名されます。SDKを使用する場合は、自分でリクエストに署名する方法を学ぶ必要はありません。たとえば、Java開発者は署名を計算するためのモデルとして、Java用AWS SDKの[AWS4Signer.java](https://github.com/aws/aws-sdk-java/blob/master/aws-java-sdk-core/src/main/java/com/amazonaws/auth/AWS4Signer.java)を使用できます。[AWS GitHubリポジトリ](https://github.com/aws)には、他の言語用のSDKも用意されています。

リクエストを作成して署名するには、次の操作を行います。

1. 正規リクエストを作成する

   AWSドキュメントの「[タスク1： 署名バージョン4の正規リクエストを作成する](https://docs.aws.amazon.com/ja_jp/general/latest/gr/sigv4-create-canonical-request.html)」に従って、このガイダンスを使用します。

   -   正規リクエストの作成時に開始する署名なしリクエストの例については、「[ステップ3.URIにヘッダーを追加する](#ステップ3URIにヘッダーを追加する)」をご覧ください。
   -   ハッシュアルゴリズムにはSHA-256を使用します。
   -   クエリパラメーターには認証情報を入れないでください。これは`Authorization`ヘッダーパラメーターに含めてください。認証情報に`Authorization`ヘッダーパラメーターを使用する方法については、「[Authorizationヘッダー](#Authorizationヘッダー)」をご覧ください。

2. 署名する文字列を作成する

   AWSドキュメントの「[タスク2： 署名バージョン4の署名文字列を作成する](https://docs.aws.amazon.com/ja_jp/general/latest/gr/sigv4-create-string-to-sign.html)」に従って、このガイダンスを使用します。

   -   アルゴリズムの指定値は、`AWS4-HMAC-SHA256`です。
   -   認証情報スコープを決定するには、「[認証情報スコープ](#認証情報スコープ)」をご覧ください。

3. 署名を計算する

   AWSドキュメントの「[タスク3： AWS署名バージョン4の署名を計算する](https://docs.aws.amazon.com/ja_jp/general/latest/gr/sigv4-calculate-signature.html)」に従います。

   **Important:** 「[認証情報スコープ](#認証情報スコープ)」のセクションを参照して、この手順を完了してください。

4. 署名情報を追加する

   AWSドキュメントの「[タスク4： HTTPリクエストに署名を追加する](https://docs.aws.amazon.com/ja_jp/general/latest/gr/sigv4-add-signature-to-request.html)」に従って、このガイダンスを使用します。

   -   クエリ文字列には署名情報を追加しないでください。これは`Authorization`ヘッダーパラメーターに追加します。
   -   `Authorization`ヘッダーパラメーターの作成について詳しくは、「[Authorizationヘッダー](#Authorizationヘッダー)」をご覧ください。
       次の例では、`Authorization`ヘッダーを使用して署名情報を追加した後で、リクエストがどのように表示されるかを示します。

   ```
   GET /sellers/v1/marketplaceParticipations?marketplace=ATVPDKIKX0DER HTTP/1.1
   Authorization: AWS4-HMAC-SHA25Credential=AKIDEXAMPLE/20190430/us-east1/execute-api/aws4_request, SignedHeaders=host;user-agent;x-amz-access-token, Signature=5d672d79c15b13162d9279b0855cfba6789a8edb4c82c400e06b5924aEXAMPLE
   host: sellingpartnerapi-na.amazon.com
   user-agent: My Selling Tool/2.0 (Language=Java/1.8.0.221; Platform=Windows/10)
   x-amz-access-token=Atza|IQEBLjAsAhRmHjNgHpi0U-Dme37rR6CuUpSREXAMPLE
   x-amz-date: 20190430T123600Z
   ```


-   **[認証情報スコープ](#認証情報スコープ)**  

-   **[Authorizationヘッダー](#Authorizationヘッダー)**  


**Parent topic:** [出品パートナーAPIへの接続](#出品パートナーAPIへの接続)



#### 認証情報スコープ

認証情報スコープとは、出品パートナーAPIへのリクエストに署名する際に作成する「署名文字列」のコンポーネントです。「[ステップ4.リクエストの作成と署名](#ステップ4リクエストの作成と署名)」をご覧ください。

認証情報スコープは、次の表に示すように、スラッシュで区切られたディメンション文字列で表されます。

| ディメンション | 説明                                                         | 例             |
| :------------- | :----------------------------------------------------------- | :------------- |
| 日付           | リクエストの年（YYYY）、月（MM）、日（DD）を表す8桁の文字列。 | `20190430`     |
| AWSリージョン  | リクエストを送信するリージョン。「[出品パートナーAPIエンドポイント](#出品パートナーAPIエンドポイント)」をご覧ください。 | `us-east-1`    |
| サービス       | リクエストしているサービス。この値はエンドポイントにあります。「[出品パートナーAPIエンドポイント](#出品パートナーAPIエンドポイント)」をご覧ください。 | `execute-api`  |
| 終了文字列     | 特別な終了文字列。AWS署名バージョン4の場合、値は`aws4_request`です。 | `aws4_request` |

たとえば、次のようになります。

```
20190430/us-east-1/execute-api/aws4_request
```

**Important:** 認証情報スコープの一部として使用する日付は、`x-amz-date`ヘッダーで指定されたリクエストの日付と一致する必要があります。詳しくは、AWSドキュメントの「[署名バージョン4の日付の処理](https://docs.aws.amazon.com/ja_jp/general/latest/gr/sigv4-date-handling.html)」をご覧ください。

詳しくは、「[ステップ4.リクエストの作成と署名](#ステップ4リクエストの作成と署名)」をご覧ください。

**Parent topic:** [ステップ4.リクエストの作成と署名](#ステップ4リクエストの作成と署名)



#### Authorizationヘッダー

`Authorization`ヘッダーには、要求に対する署名情報が含まれます。ヘッダーは「Authorization」という名前ですが、署名情報は認証に使用されるものです。

Authorizationヘッダーのコンポーネントは次のとおりです。

| コンポーネント               | 説明                                                         |
| :--------------------------- | :----------------------------------------------------------- |
| 署名に使用されるアルゴリズム | 署名プロセス全体で使用されるハッシュアルゴリズム。出品パートナーAPIにはSHA-256が必要です。これを[ステップ4.リクエストの作成と署名](#ステップ4リクエストの作成と署名)で指定します。 |
| `認証情報`                   | AWSアクセスキーIDと[認証情報スコープ](#認証情報スコープ)。AWSアクセスキーIDは、[ステップ3.IAMユーザーを作成する](#ステップ3IAMユーザーを作成する)で取得します。 |
| `SignedHeaders`              | 署名付きリクエストに含めたすべてのHTTPヘッダーのリスト。例については、「[ステップ3.URIにヘッダーを追加する](#ステップ3URIにヘッダーを追加する)」をご覧ください。 |
| `署名`                       | [ステップ4.リクエストの作成と署名](#ステップ4リクエストの作成と署名)で計算された署名。 |

たとえば、次のようになります。

```
Authorization: AWS4-HMAC-SHA25 Credential=AKIDEXAMPLE/20190430/us-east1/execute-api/aws4_request, SignedHeaders=host;user-agent;x-amz-accesstoken;x-amz-date, Signature=5d672d79c15b13162d9279b0855cfba6789a8edb4c82c400e06b5924aEXAMPLE
```

詳しくは、「[ステップ4.リクエストの作成と署名](#ステップ4リクエストの作成と署名)」をご覧ください。

**Parent topic:** [ステップ4.リクエストの作成と署名](#ステップ4リクエストの作成と署名)



# レスポンスのフォーマット

HTTPリクエストに応答すると、出品パートナーAPIよりレスポンスヘッダーとJSONレスポンスメッセージが返されます。

**レスポンスヘッダー**

| 名前               | 説明                                                         |
| :----------------- | :----------------------------------------------------------- |
| `Content-Length`   | 標準HTTPレスポンスヘッダー。                                 |
| `Content-Type`     | 標準HTTPレスポンスヘッダー。                                 |
| `Date`             | 標準HTTPレスポンスヘッダー。                                 |
| `x-amzn-RequestId` | リクエストID。サポートが必要な場合は、問い合わせ時にこの内容をお伝えください。 |

## 成功レスポンス

リクエストが成功すると、出品パートナーAPIから要求されたデータが返されます。成功レスポンスの例を次に示します。

```
HTTP/1.1 200 OK
Content-Length: 368
Content-Type: application/json
Date: Thu, 0Jun 20122:23:31 GMT
x-amzn-RequestId: 6875f61f-6aa1-11e8-98c6-9b9a3a7283a4
{
    "payload": [
        {
            "marketplace": {
                "id": "ATVPDKIKX0DER",
                "countryCode": "US",
                "name": "Amazon.com",
                "defaultCurrencyCode": "USD",
                "defaultLanguageCode": "en_US",
                "domainName": "www.amazon.com"
            },
            "participation": {
                "isParticipating": true,
                "hasSuspendedListings": false
            }
        }
    ]
}
```

## エラーレスポンス

リクエストが失敗すると、出品パートナーAPIからエラーレスポンスが返されます。エラーレスポンスのレスポンスメッセージに含まれる要素は次のとおりです。

**レスポンスメッセージ**

| 要素      | 説明                   | 必須   |
| :-------- | :--------------------- | :----- |
| `code`    | HTTPステータスコード。 | はい   |
| `message` | エラー状態の説明。     | はい   |
| `details` | 追加情報へのリンク。   | いいえ |

エラーレスポンスの例を次に示します。

```
HTTP/1.1 400 Bad Request
Content-Length: 117
Content-Type: application/json
Date: Fri, 0Jun 20100:48:2GMT
x-amzn-ErrorType: ValidationException
x-amzn-RequestId: a8c8d99a-6ab5-11e8-b0f8-19363980175b
{
    "errors": [
        {
            "message": "Access to requested resource is denied.",
            "code": "Unauthorized",
            "details": "Access token is missing in the request header."
        }
    ]
}
```



# 許可不要のオペレーション

許可不要のオペレーションとは、出品パートナーからの明示的な認可なしに呼び出すことができるオペレーションです。この認可モデルでは、他のSelling Partner APIオペレーションを呼び出す際とは異なり、LWA認証コードとリフレッシュトークンを受け取り、交換して、LWAアクセストークンを取得する必要はありません。代わりに、LWA認可サーバーの1回の呼び出しでLWAアクセストークンを取得します。

現在、Selling Partner APIでは、`GET/authorization/v1/authorizationCode`オペレーションのみが許可不要のオペレーションとなります。

許可不要のオペレーションを呼び出すには、[出品パートナーAPIへの接続](#出品パートナーAPIへの接続)の手順を実行し、この重要なバリエーションでは、[ステップ1.Login with Amazonアクセストークンをリクエストする](#ステップ1Login-with-Amazonアクセストークンをリクエストする)の指示を以下のセクションに記載の指示と置き換えてください。 **Login with Amazonアクセストークンをリクエストして、許可不要のオペレーションを呼び出します**。

## Login with Amazonアクセストークンをリクエストして、許可不要のオペレーションを呼び出します。

Login with Amazon（LWA）アクセストークンにより、開発者のアプリケーションが出品パートナーの代わりに特定のアクションを実行することが認可されます。LWAアクセストークンは発行後1時間で失効し、また、Selling Partner APIへのすべてのリクエストに含める必要があります。

LWAアクセストークンをリクエストするには、次のパラメーターを使用して、LWA認証サーバー（https://api.amazon.com/auth/o2/token）に安全なHTTP POSTを実行します。

| 名前            | 説明                                                         | 必須 |
| :-------------- | :----------------------------------------------------------- | ---- |
| `grant_type`    | 要求されるアクセス許可のタイプ。`client_credentials`である必要があります。 | はい |
| `scope`         | 認可グラントの範囲。Authorization APIの`GET/authorization/v1/authorizationCode`オペレーションを呼び出すためのLWAアクセストークンをリクエストする場合は、値を`sellingpartnerapi::migration`とする必要があります。 | はい |
| `client_id`     | アプリケーションを登録するときにこの値を取得します。「[開発者情報の表示](#開発者情報の表示)」をご覧ください。 | はい |
| `client_secret` | アプリケーションを登録するときにこの値を取得します。「[開発者情報の表示](#開発者情報の表示)」をご覧ください。 | はい |

たとえば、次のようになります。

```
POST /auth/o2/token HTTP/l.l
Host: api.amazon.com
Content-Type: application/x-www-form-urlencoded;charset=UTF-8

grant_type=client_credentials
&scope=sellingpartnerapi::migration
&client_id=foodev
&client_secret=Y76SDl2F
```



# スロットリング：リクエストを送信できる頻度を制限する

スロットリングとは、一定期間内に出品パートナーAPIでアプリケーションがオペレーションに対して実行できるリクエスト数を制限するプロセスです。スロットリングは、リクエストがウェブサービスに殺到するのを防ぎ、認証されたすべてのアプリケーションが確実にウェブサービスにアクセスできるようにするものです。

出品パートナーAPIのスロットリング制限は、オペレーションごとに、すべての出品者/アプリケーションペアに適用されます。つまり、出品者/アプリケーションのペアに対する1つの操作のスロットルは、同じ出品者/アプリケーションのペアに対する他の操作のスロットルに影響しません。

Selling Partner APIでは、[トークンバケットアルゴリズム](https://en.wikipedia.org/wiki/Token_bucket)を使用してトークンでリクエストをカウントし、APIへのリクエストを調整します。このサービスでは、各オペレーションに対して定常レートとバーストに対して制限を設定します。トークンバケットアルゴリズムでは、バーストは最大バケットサイズです。

## Selling Partner APIのスロットリング制限

| オペレーション                             | **レート（1分あたりのリクエスト数）** | バースト |
| :----------------------------------------- | :------------------------------------ | :------- |
| `GET/authorization/v1/authorizationCode`   | 60                                    | 5        |
| `GET/sales/v1/orderMetrics`                | .5                                    | 15       |
| `GET/sellers/v1/marketplaceParticipations` | .016                                  | 15       |



# すべてのリクエストにUser-Agentヘッダーを含める

User-Agentヘッダーは、アプリケーションとそのバージョン番号、および使用しているプラットフォームとプログラミング言語を識別します。出品パートナーAPIに送信するすべてのリクエストには、User-Agentヘッダーを含めてください。これにより、Amazonはより効率良く問題を診断して解決でき、サービスをより快適に使用いただくことにつながります。

User-Agentヘッダーを作成するには、使用しているアプリケーション名から開始し、スラッシュ、アプリケーションのバージョン、スペース、左丸括弧、言語名と値のペア、右丸括弧の順に入力します。言語パラメーターは必須の属性ですが、セミコロンで区切ることでその他の属性を追加することができます。

次の擬似コードは、受け入れ可能な最小限度の条件を満たすUser-Agentヘッダーを説明するものです。

```
AppId/AppVersionId (Language=LanguageNameAndOptionallyVersion)
```

以下に、アプリケーションインテグレーターで使用されるUser-Agentヘッダーの例を示します。

```
My Selling Tool/2.0 (Language=Java/1.8.0.221; Platform=Windows/10)
```

自社のIT部門を通じて統合を行う大口出品者の場合は、次の例のように、Host属性を含むUser-Agentヘッダーの作成を検討してください。これにより、Amazonサポートエンジニアは問題のトラブルシューティングをより効果的に行うことができます。

```
MyCompanyName/build1611 (Language=Perl; Host=jane.desktop.example.com)
```

その他の属性を指定するには、セミコロンで各名前と値のペアを分離して、フォーマット`AttributeName=Value;`を使用してください。バックスラッシュ（`\`）を使用したい場合は、2つつなげて（`\\`）エスケープして使用してください。アプリケーション名内のスラッシュ（`\/`）、アプリケーションバージョン内の左丸括弧（`\(`）、属性名内の等号（`\=`）、右丸括弧（`\)`）および属性値内のセミコロン（`\;`）についても同様にエスケープし使用してください。

User-Agentヘッダーはすべてのリクエストで送信されるので、ヘッダーのサイズを制限することをお勧めします。出品パートナーAPIでは、500文字を超えると、User-Agentヘッダーが拒否されます。



# Selling Partner APIサンドボックス

Selling Partner APIでは、実稼動データに影響を与えたり、実際のイベントを発生させたりすることなく、アプリケーションをテストできるサンドボックス環境が提供されます。Selling Partner APIをサンドボックスで呼び出す方法は、[Selling Partner APIサンドボックスのエンドポイント](#Selling-Partner-APIサンドボックスのエンドポイント)に呼び出しを指示する以外は、実稼働で呼び出す場合と同じです。サンドボックスエンドポイントを呼び出すと、すべてのSelling Partner APIに対して静的な模擬レスポンスが返されます。呼び出すAPIのSwaggerモデルJSONファイルで、これらの模擬レスポンスを参照できます。詳しくは、「[Selling Partner APIをサンドボックスで呼び出す方法](#Selling-Partner-APIをサンドボックスで呼び出す方法)」をご覧ください。

Selling Partner APIサンドボックスは、多くの模擬フレームワークと同じように機能し、指定されたパラメーターが存在する場合は、パターンマッチングを使用して、指定されたレスポンスを返します。開発者が、指定されたパラメーターに一致するリクエストを送信すると、x-amazon-spds-sandbox-behaviorsオブジェクトで定義されたレスポンスが返されます。x-amazon-spds-sandbox-behaviorsオブジェクトで指定されていないパラメーターがAPIで必要な場合は、リクエストが有効な限り、リクエスト内のパラメーター値に関係なく、サンドボックスからレスポンスが返されます。

**Important:** サンドボックスは、拡張性のテストではなく、機能をテストするためのものです。サンドボックスエンドポイントの呼び出しには、**rate** = 1 秒あたり5リクエスト、**burst** = 15 のスロットリング制限が適用されます。スロットリングについて詳しくは、「[スロットリング：リクエストを送信できる頻度を制限する](#スロットリングリクエストを送信できる頻度を制限する)」をご覧ください。

Selling Partner APIのパブリックリリース版では、サンドボックス呼び出しの入力検証が含まれ、無効なリクエストに対して現実的なエラーメッセージが表示されるようになります。

-   **[Selling Partner APIをサンドボックスで呼び出す方法](#Selling-Partner-APIをサンドボックスで呼び出す方法)**  

-   **[Selling Partner APIサンドボックスのエンドポイント](#Selling-Partner-APIサンドボックスのエンドポイント)**  



## Selling Partner APIをサンドボックスで呼び出す方法

## ステップ1.呼び出すAPIのSwaggerモデルJSONファイルを取得する

1.  [github.com/amzn](https://github.com/amzn)にアクセスします。
2.  「amazon-marketplace-api-sdk」を検索し、表示される**amazon-marketplace-api-sdk**リンクをクリックします。
3.  呼び出すAPIのJSONファイルをダウンロードします。

## ステップ2.リクエストパラメーターのJSONファイルをチェックする

1. 前の手順でダウンロードしたJSONファイルを開きます。

2. 「x-amazon-spds-sandbox-behaviors」を検索します。

   JSONファイルのx-amazon-spds-sandbox-behaviorオブジェクトには、APIのサンドボックス呼び出しのリクエストとレスポンスの例が含まれています。リクエスト例にパラメーターが含まれている場合は、次のステップで使用します。


## ステップ3.APIをサンドボックスで呼び出す

APIをサンドボックスで呼び出す方法は、実稼働で呼び出す方法と同じですが、以下の違いがあります。

1. JSONファイルのx-amazon-spds-sandbox-behaviorオブジェクト内のリクエストオブジェクトに1つ以上のパラメーターと値のペアが含まれている場合は、呼び出し時にそれらを指定します。

2. [Selling Partner APIサンドボックスエンドポイント](#Selling-Partner-APIサンドボックスエンドポイント)の1つを呼び出す指示をします。

   受信するレスポンスは、JSONファイルのx-amazon-spds-sandbox-behaviorオブジェクトに含まれるペイロードオブジェクトと一致する必要があります。


**Parent topic:** [Selling Partner APIサンドボックス](#Selling-Partner-APIサンドボックス)



## Selling Partner APIサンドボックスのエンドポイント

Selling Partner APIには、北米、ヨーロッパ、極東地域の出品リージョン向けのサンドボックスエンドポイントがあります。詳しくは、「[Selling Partner APIサンドボックス](#Selling-Partner-APIサンドボックス)」をご覧ください。

| 出品リージョン                                               | エンドポイント                                    | AWSリージョン |
| :----------------------------------------------------------- | :------------------------------------------------ | :------------ |
| 北米（カナダ、米国、メキシコ、ブラジルのマーケットプレイス） | `https://sandbox.sellingpartnerapi-na.amazon.com` | `us-east-1`   |
| ヨーロッパ（スペイン、イギリス、フランス、ドイツ、イタリア、トルコ、アラブ首長国連邦、インドのマーケットプレイス） | `https://sandbox.sellingpartnerapi-eu.amazon.com` | `eu-west-1`   |
| 極東地域（シンガポール、オーストラリア、日本のマーケットプレイス） | `https://sandbox.sellingpartnerapi-fe.amazon.com` | `us-west-2`   |

**Parent topic:** [Selling Partner APIサンドボックス](#Selling-Partner-APIサンドボックス)



# よくあるご質問

## Amazonマーケットプレイスウェブサービスと出品パートナーAPIとの違いは何ですか？

出品パートナーAPIとAmazonマーケットプレイスウェブサービス（Amazon MWS）はいずれも、出品者のデータにプログラムでアクセスできるウェブサービスですが、大きな違いがあります。出品パートナーAPIとAmazon MWSの主な相違点は次のとおりです。

-   出品パートナーAPIは、RESTに適合したリソースとしてデータを処理し、標準的なHTTPメソッドを介してアクセスおよび変更できます。一方、Amazon MWSは、Amazon MWS固有のオペレーションを使用してデータを公開します。
-   出品パートナーAPIの認可は、AmazonのOAuth 2.0実装であるLWAを活用します。このモデルにより、Amazon MWSで要求される認可トークンを手動で交換する必要がなくなります。「[アプリケーションの出品パートナーAPI認可](#アプリケーションの出品パートナーAPI認可)」をご覧ください。
-   Amazon MWSでは、出品者が開発者を認可します。出品パートナーAPIでは、出品者がアプリケーションを認可します。開発者は、出品パートナーAPIを使用することで、出品者のデータに対して複数のアクセスレベルを要する複数のアプリケーションを作成できます。
-   出品パートナーAPIでは、Amazon MWSよりも細かいデータアクセスコントロールが可能です。開発者は必要なデータのみに対するアクセスをリクエストでき、出品者はAPIセクション、オペレーション、またはデータリソースレベルで権限を付与できます。
-   出品パートナーAPIでは、AWS IDとアクセス管理（IAM）を使用して、固有の認証情報を直接入手し管理できます。Amazon MWSでは、特別な登録ワークフローを使用してAmazonから提供された認証情報を受け取ります。また、Amazon MWSサポートに連絡すると、新しい認証情報が取得されます。「[ステップ3.IAMユーザーを作成する](#ステップ3IAMユーザーを作成する)」をご覧ください。
-   出品パートナーAPIでは、認証にAWS署名バージョン4を使用します。Amazon MWSでは署名バージョン2を使用しています。「[ステップ4.リクエストの作成と署名](#ステップ4リクエストの作成と署名)」をご覧ください。

